- name: Deploy to VM and restart Flask
  uses: appleboy/ssh-action@v0.1.9
  with:
    host: ${{ secrets.VM_HOST }}
    username: ${{ secrets.VM_USER }}
    password: ${{ secrets.VM_PASSWORD }}
    port: 22
    debug: true
    script: |
      cd /home/manisha/flask-ci-cd-app
      git pull origin main
      source /home/manisha/venv/bin/activate
      pkill -f "python3 app.py" || true
      nohup python app.py > app.log 2>&1 &
